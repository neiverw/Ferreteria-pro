# üìñ Manual de Uso - Sistema de Gesti√≥n para Ferreter√≠a

---

## üìë Tabla de Contenidos

1. [C√≥mo se Usa](#1-c√≥mo-se-usa)
   - [Inicio de Sesi√≥n](#11-inicio-de-sesi√≥n)
   - [Navegaci√≥n Principal](#12-navegaci√≥n-principal)
   - [Dashboard](#13-dashboard)
   - [Gesti√≥n de Inventario](#14-gesti√≥n-de-inventario)
   - [Gesti√≥n de Proveedores](#15-gesti√≥n-de-proveedores)
   - [Sistema de Facturaci√≥n](#16-sistema-de-facturaci√≥n)
   - [Gesti√≥n de Clientes](#17-gesti√≥n-de-clientes)
   - [Reportes](#18-reportes)
   - [Configuraci√≥n](#19-configuraci√≥n)

2. [C√≥mo Funciona](#2-c√≥mo-funciona)
   - [Arquitectura del Sistema](#21-arquitectura-del-sistema)
   - [Sistema de Autenticaci√≥n](#22-sistema-de-autenticaci√≥n)
   - [Roles y Permisos](#23-roles-y-permisos)
   - [Flujo de Datos](#24-flujo-de-datos)
   - [Base de Datos](#25-base-de-datos)
   - [Gesti√≥n de Estado](#26-gesti√≥n-de-estado)

3. [Tecnolog√≠as Utilizadas y Detalles Extra](#3-tecnolog√≠as-utilizadas-y-detalles-extra)
   - [Stack Tecnol√≥gico](#31-stack-tecnol√≥gico)
   - [Librer√≠as y Dependencias](#32-librer√≠as-y-dependencias)
   - [Estructura del Proyecto](#33-estructura-del-proyecto)
   - [Caracter√≠sticas Especiales](#34-caracter√≠sticas-especiales)
   - [Seguridad](#35-seguridad)
   - [Rendimiento](#36-rendimiento)

---

## 1. C√≥mo se Usa

### 1.1 Inicio de Sesi√≥n

#### Acceso al Sistema
1. **Abrir la aplicaci√≥n** en tu navegador web
2. Se mostrar√° la pantalla de inicio de sesi√≥n
3. **Ingresar credenciales:**
   - Usuario (username)
   - Contrase√±a
4. Hacer clic en **"Iniciar Sesi√≥n"**

#### Tipos de Usuario
El sistema cuenta con 3 tipos de usuarios, cada uno con permisos espec√≠ficos:

- **üëë Administrador (admin):** Acceso completo a todas las funcionalidades
- **üí≥ Cajero:** Acceso a inventario, facturaci√≥n, clientes y reportes
- **üì¶ Bodega:** Acceso limitado a inventario y reportes

### 1.2 Navegaci√≥n Principal

La interfaz est√° dividida en dos √°reas principales:

#### Barra Lateral (Sidebar)
- **Logo y nombre de la empresa** en la parte superior
- **Men√∫ de navegaci√≥n** con iconos identificables:
  - üìä Dashboard
  - üì¶ Inventario
  - üë• Proveedores
  - üìÑ Facturaci√≥n
  - üë§ Clientes
  - üìà Reportes
  - ‚öôÔ∏è Configuraci√≥n
- **Informaci√≥n del perfil** en la parte inferior

#### Barra Superior (Header)
- **Bot√≥n de men√∫** (para mostrar/ocultar sidebar)
- **T√≠tulo de la secci√≥n actual**
- **Informaci√≥n del usuario:**
  - Icono de rol
  - Nombre del usuario
  - Bot√≥n "Salir"
- **Fecha actual** (formato colombiano)

### 1.3 Dashboard

El Dashboard es la vista principal que muestra un resumen general del negocio.

#### Elementos del Dashboard:
- **üìä Tarjetas de m√©tricas principales:**
  - Ventas del mes
  - Productos en inventario
  - Clientes activos
  - Pedidos pendientes

- **üìà Gr√°ficos visuales:**
  - Tendencia de ventas
  - Productos m√°s vendidos
  - Comparativas mensuales

- **‚ö° Alertas importantes:**
  - Productos con bajo stock
  - Productos pr√≥ximos a vencer
  - Pedidos pendientes

### 1.4 Gesti√≥n de Inventario

Esta secci√≥n permite administrar todos los productos de la ferreter√≠a.

#### Funcionalidades Principales:

##### 1.4.1 Ver Inventario
- **Tabla de productos** con columnas:
  - C√≥digo/SKU
  - Nombre del producto
  - Categor√≠a
  - Proveedor
  - Stock actual
  - Precio de compra
  - Precio de venta
  - Estado
  - Acciones

- **B√∫squeda y filtros:**
  - Buscar por nombre o c√≥digo
  - Filtrar por categor√≠a
  - Filtrar por proveedor
  - Filtrar por estado (activo/inactivo)

##### 1.4.2 Agregar Producto
1. Hacer clic en **"+ Nuevo Producto"**
2. Completar el formulario:
   - C√≥digo/SKU (√∫nico)
   - Nombre del producto
   - Descripci√≥n
   - Categor√≠a
   - Proveedor
   - Stock inicial
   - Stock m√≠nimo (para alertas)
   - Precio de compra
   - Precio de venta
   - Fecha de vencimiento (opcional)
   - Ubicaci√≥n en bodega
3. Hacer clic en **"Guardar"**

##### 1.4.3 Editar Producto
1. Hacer clic en el **icono de l√°piz** en la fila del producto
2. Modificar los campos necesarios
3. Hacer clic en **"Actualizar"**

##### 1.4.4 Gestionar Stock
- **Aumentar stock:**
  - Clic en "+" para agregar unidades
  - Ingresar cantidad y justificaci√≥n
  
- **Disminuir stock:**
  - Clic en "-" para reducir unidades
  - Ingresar cantidad y motivo

- **Ajuste de inventario:**
  - Opci√≥n para corregir diferencias
  - Requiere autorizaci√≥n seg√∫n el rol

##### 1.4.5 Alertas de Inventario
El sistema genera alertas autom√°ticas:
- üî¥ **Stock bajo:** Cuando el stock es igual o menor al m√≠nimo
- ‚ö†Ô∏è **Pr√≥ximo a vencer:** Productos a 30 d√≠as de su vencimiento
- ‚ùå **Sin stock:** Productos agotados

### 1.5 Gesti√≥n de Proveedores

Administra la informaci√≥n de los proveedores de la ferreter√≠a.

#### 1.5.1 Ver Proveedores
- **Listado de proveedores** con:
  - Nombre
  - NIT/Identificaci√≥n
  - Contacto
  - Tel√©fono
  - Email
  - Direcci√≥n
  - Estado (activo/inactivo)
  - Productos suministrados

#### 1.5.2 Agregar Proveedor
1. Hacer clic en **"+ Nuevo Proveedor"**
2. Completar informaci√≥n:
   - Nombre comercial
   - NIT o identificaci√≥n
   - Persona de contacto
   - Tel√©fono
   - Email
   - Direcci√≥n
   - Ciudad
   - Notas adicionales
3. Guardar

#### 1.5.3 Asociar Productos
- Ver productos del proveedor
- Agregar nuevos productos
- Actualizar precios de compra
- Gestionar cat√°logo

#### 1.5.4 Historial
- Compras realizadas
- Facturas
- Notas de cr√©dito
- Saldo pendiente

### 1.6 Sistema de Facturaci√≥n

Genera y gestiona las ventas y facturas del negocio.

#### 1.6.1 Crear Nueva Factura
1. Hacer clic en **"Nueva Factura"**
2. **Seleccionar o crear cliente:**
   - Buscar cliente existente
   - Crear nuevo cliente r√°pido
3. **Agregar productos:**
   - Buscar producto por nombre o c√≥digo
   - Escanear c√≥digo de barras (si est√° disponible)
   - Ajustar cantidad
   - Aplicar descuentos (si tiene permiso)
4. **Revisar totales:**
   - Subtotal
   - Descuentos
   - IVA
   - Total
5. **Seleccionar m√©todo de pago:**
   - Efectivo
   - Tarjeta
   - Transferencia
   - Cr√©dito
6. **Procesar venta:**
   - Confirmar factura
   - Imprimir/Descargar PDF
   - Enviar por correo (opcional)

#### 1.6.2 Gestionar Facturas
- **Ver historial de facturas**
- **Buscar facturas:**
  - Por n√∫mero
  - Por cliente
  - Por fecha
  - Por monto
- **Acciones:**
  - Ver detalle
  - Reimprimir
  - Anular (con permisos de admin)
  - Aplicar notas cr√©dito

#### 1.6.3 Caja
- **Abrir caja:** Registrar dinero inicial
- **Movimientos de caja:**
  - Ingresos
  - Egresos
  - Notas
- **Cerrar caja:**
  - Conteo final
  - Reporte de cierre
  - Diferencias

### 1.7 Gesti√≥n de Clientes

Administra la base de datos de clientes.

#### 1.7.1 Ver Clientes
- **Listado completo** con:
  - Nombre
  - Tipo de documento
  - N√∫mero de documento
  - Tel√©fono
  - Email
  - Direcci√≥n
  - Total de compras
  - √öltima compra

#### 1.7.2 Agregar Cliente
1. Clic en **"+ Nuevo Cliente"**
2. Informaci√≥n requerida:
   - Nombre completo
   - Tipo de documento (CC, NIT, CE, etc.)
   - N√∫mero de documento
   - Tel√©fono
   - Email
   - Direcci√≥n
   - Ciudad
3. Guardar

#### 1.7.3 Perfil del Cliente
- **Datos personales**
- **Historial de compras:**
  - Facturas
  - Total gastado
  - Productos m√°s comprados
- **Cr√©ditos:**
  - L√≠mite de cr√©dito
  - Saldo actual
  - Pagos pendientes
- **Notas:**
  - Observaciones especiales
  - Preferencias

### 1.8 Reportes

Genera reportes detallados para an√°lisis del negocio.

#### 1.8.1 Tipos de Reportes

##### Reportes de Ventas
- **Ventas diarias:** Resumen por d√≠a
- **Ventas mensuales:** Comparativa mensual
- **Ventas por producto:** Productos m√°s vendidos
- **Ventas por categor√≠a:** Categor√≠as m√°s rentables
- **Ventas por cliente:** Mejores clientes

##### Reportes de Inventario
- **Movimientos de inventario:** Entradas y salidas
- **Valorizaci√≥n de inventario:** Valor total del stock
- **Productos sin movimiento:** Items estancados
- **Productos con rotaci√≥n alta:** M√°s vendidos
- **Alertas de stock:** Productos cr√≠ticos

##### Reportes Financieros
- **Utilidad por per√≠odo:** Ganancia neta
- **Flujo de caja:** Ingresos vs egresos
- **Cuentas por cobrar:** Cartera
- **Cuentas por pagar:** Deudas con proveedores

##### Reportes de Compras
- **Compras por proveedor**
- **Comparativa de precios**
- **Historial de √≥rdenes**

#### 1.8.2 Generar Reportes
1. Seleccionar **tipo de reporte**
2. Configurar **filtros:**
   - Rango de fechas
   - Categor√≠as
   - Proveedores
   - Clientes
3. Hacer clic en **"Generar"**
4. **Visualizar:** Gr√°ficos y tablas
5. **Exportar:**
   - PDF
   - Excel
   - CSV

#### 1.8.3 Gr√°ficos Interactivos
- Gr√°ficos de barras
- Gr√°ficos de l√≠neas
- Gr√°ficos circulares
- Tendencias
- Comparativas

### 1.9 Configuraci√≥n

Panel de configuraci√≥n del sistema (solo accesible para Administradores).

#### 1.9.1 Configuraci√≥n de la Empresa
- **Informaci√≥n b√°sica:**
  - Nombre de la empresa
  - NIT/RUT
  - Direcci√≥n
  - Tel√©fono
  - Email
  - Sitio web
  - Logo

#### 1.9.2 Configuraci√≥n de Facturaci√≥n
- **Numeraci√≥n:**
  - Prefijo de facturas
  - N√∫mero inicial
  - Resoluci√≥n DIAN (Colombia)
- **IVA y impuestos:**
  - Porcentaje de IVA
  - Otros impuestos
- **M√©todos de pago:**
  - Activar/desactivar m√©todos

#### 1.9.3 Gesti√≥n de Usuarios
- **Ver usuarios del sistema**
- **Crear nuevo usuario:**
  - Username
  - Nombre completo
  - Email
  - Rol (admin/cajero/bodega)
  - Contrase√±a inicial
- **Editar usuarios:**
  - Cambiar rol
  - Actualizar informaci√≥n
  - Resetear contrase√±a
- **Desactivar usuarios**

#### 1.9.4 Categor√≠as de Productos
- **Crear categor√≠as:** Organizar productos
- **Editar categor√≠as:** Modificar nombres
- **Eliminar categor√≠as:** Solo si no tienen productos

#### 1.9.5 Configuraci√≥n del Sistema
- **Zona horaria**
- **Formato de fecha**
- **Moneda**
- **Idioma**
- **Notificaciones:**
  - Stock bajo
  - Productos vencidos
  - Recordatorios

#### 1.9.6 Backup y Seguridad
- **Respaldo de datos:**
  - Backup autom√°tico
  - Descargar backup manual
- **Logs del sistema:**
  - Historial de acciones
  - Auditor√≠a
- **Seguridad:**
  - Cambiar contrase√±a
  - Sesiones activas
  - Verificaci√≥n en dos pasos (2FA)

---

## 2. C√≥mo Funciona

### 2.1 Arquitectura del Sistema

El sistema est√° construido con una arquitectura moderna de aplicaci√≥n web:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           NAVEGADOR (Cliente)               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ         React/Next.js App             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  (Interfaz de Usuario - Frontend)     ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ HTTPS/API Calls
                   ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         SERVIDOR (Next.js)                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ       API Routes (Backend)            ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Autenticaci√≥n                      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Gesti√≥n de datos                   ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - L√≥gica de negocio                  ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ SQL Queries
                   ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        SUPABASE (Base de Datos)             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ      PostgreSQL Database              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Tablas de datos                    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Relaciones                         ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Procedimientos almacenados         ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ     Authentication Service            ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Gesti√≥n de usuarios                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Sesiones                           ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Seguridad                          ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.2 Sistema de Autenticaci√≥n

#### Flujo de Inicio de Sesi√≥n:
1. **Usuario ingresa credenciales** ‚Üí Formulario env√≠a datos
2. **API valida en Supabase** ‚Üí Verifica username/password
3. **Supabase Auth crea sesi√≥n** ‚Üí Token JWT generado
4. **Sistema obtiene perfil** ‚Üí Lee tabla `profiles`
5. **Asigna permisos seg√∫n rol** ‚Üí Carga interfaz personalizada

#### Gesti√≥n de Sesiones:
- **Tokens JWT:** Autenticaci√≥n segura basada en tokens
- **Refresh autom√°tico:** Tokens se renuevan autom√°ticamente
- **Persistencia:** Sesi√≥n se mantiene entre recargas
- **Cierre de sesi√≥n:** Limpia tokens y redirige a login

#### Seguridad:
- Contrase√±as hasheadas (bcrypt)
- Tokens con expiraci√≥n
- HTTPS obligatorio
- Protecci√≥n CSRF
- Rate limiting

### 2.3 Roles y Permisos

El sistema implementa un modelo RBAC (Role-Based Access Control):

#### Matriz de Permisos:

| M√≥dulo         | Admin | Cajero | Bodega |
|----------------|-------|--------|--------|
| Dashboard      | ‚úÖ    | ‚ùå     | ‚ùå     |
| Inventario     | ‚úÖ    | ‚úÖ     | ‚úÖ     |
| Proveedores    | ‚úÖ    | ‚ùå     | ‚ùå     |
| Facturaci√≥n    | ‚úÖ    | ‚úÖ     | ‚ùå     |
| Clientes       | ‚úÖ    | ‚úÖ     | ‚ùå     |
| Reportes       | ‚úÖ    | ‚úÖ     | ‚úÖ     |
| Configuraci√≥n  | ‚úÖ    | ‚ùå     | ‚ùå     |

#### Implementaci√≥n:
```javascript
// Verificaci√≥n de permisos en el c√≥digo
const canAccess = (permission) => {
  return user.permissions.includes(permission);
};

// Renderizado condicional
{canAccess('settings') && <SettingsButton />}
```

### 2.4 Flujo de Datos

#### Ejemplo: Crear una Factura

```
1. Usuario hace clic en "Nueva Factura"
   ‚Üì
2. Frontend carga componente BillingSystem
   ‚Üì
3. Usuario selecciona cliente y productos
   ‚Üì
4. Frontend calcula totales en tiempo real
   ‚Üì
5. Usuario confirma venta
   ‚Üì
6. Frontend env√≠a petici√≥n POST a /api/billing
   ‚Üì
7. API valida datos y permisos
   ‚Üì
8. API inicia transacci√≥n en Supabase:
   - Crea registro en tabla 'sales'
   - Crea registros en 'sale_items'
   - Actualiza stock en 'products'
   - Registra movimiento en 'inventory_movements'
   ‚Üì
9. Supabase confirma transacci√≥n
   ‚Üì
10. API responde con datos de factura
    ‚Üì
11. Frontend actualiza UI y muestra PDF
```

#### Gesti√≥n de Estado:
- **Estado local:** React useState para formularios
- **Estado global:** Context API para usuario y configuraci√≥n
- **Estado del servidor:** React Query/SWR para datos remotos
- **Cach√©:** Optimizaci√≥n de peticiones repetidas

### 2.5 Base de Datos

#### Estructura Principal:

##### Tabla: `profiles`
```sql
- user_id (UUID, FK a auth.users)
- username (VARCHAR, UNIQUE)
- name (VARCHAR)
- role (ENUM: admin, cajero, bodega)
- created_at (TIMESTAMP)
```

##### Tabla: `products`
```sql
- id (UUID, PK)
- sku (VARCHAR, UNIQUE)
- name (VARCHAR)
- description (TEXT)
- category_id (UUID, FK)
- supplier_id (UUID, FK)
- stock (INTEGER)
- min_stock (INTEGER)
- purchase_price (DECIMAL)
- sale_price (DECIMAL)
- expiry_date (DATE, NULLABLE)
- location (VARCHAR)
- is_active (BOOLEAN)
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)
```

##### Tabla: `suppliers`
```sql
- id (UUID, PK)
- name (VARCHAR)
- nit (VARCHAR, UNIQUE)
- contact_person (VARCHAR)
- phone (VARCHAR)
- email (VARCHAR)
- address (TEXT)
- city (VARCHAR)
- is_active (BOOLEAN)
- created_at (TIMESTAMP)
```

##### Tabla: `customers`
```sql
- id (UUID, PK)
- name (VARCHAR)
- document_type (VARCHAR)
- document_number (VARCHAR, UNIQUE)
- phone (VARCHAR)
- email (VARCHAR)
- address (TEXT)
- city (VARCHAR)
- credit_limit (DECIMAL)
- current_balance (DECIMAL)
- created_at (TIMESTAMP)
```

##### Tabla: `sales`
```sql
- id (UUID, PK)
- invoice_number (VARCHAR, UNIQUE)
- customer_id (UUID, FK)
- user_id (UUID, FK)
- subtotal (DECIMAL)
- tax (DECIMAL)
- discount (DECIMAL)
- total (DECIMAL)
- payment_method (ENUM)
- status (ENUM: completed, cancelled)
- created_at (TIMESTAMP)
```

##### Tabla: `sale_items`
```sql
- id (UUID, PK)
- sale_id (UUID, FK)
- product_id (UUID, FK)
- quantity (INTEGER)
- unit_price (DECIMAL)
- subtotal (DECIMAL)
- discount (DECIMAL)
- total (DECIMAL)
```

##### Tabla: `inventory_movements`
```sql
- id (UUID, PK)
- product_id (UUID, FK)
- movement_type (ENUM: in, out, adjustment)
- quantity (INTEGER)
- reason (TEXT)
- user_id (UUID, FK)
- reference_id (UUID, NULLABLE)
- created_at (TIMESTAMP)
```

#### Relaciones:
- Un proveedor tiene muchos productos
- Un producto pertenece a una categor√≠a
- Una venta tiene muchos items
- Un item pertenece a un producto
- Un movimiento est√° asociado a un producto

### 2.6 Gesti√≥n de Estado

#### Context API - AuthContext:
```javascript
// Proporciona informaci√≥n de autenticaci√≥n global
- user: Datos del usuario actual
- login(): Funci√≥n para iniciar sesi√≥n
- logout(): Funci√≥n para cerrar sesi√≥n
- isAuthenticated: Estado booleano
- loading: Estado de carga
```

#### Context API - SystemSettingsContext:
```javascript
// Proporciona configuraci√≥n del sistema
- settings: Configuraciones globales
- updateSettings(): Actualizar configuraci√≥n
```

#### Hooks Personalizados:
- **useAuth():** Acceso a contexto de autenticaci√≥n
- **usePermissions():** Verificaci√≥n de permisos
- **useSystemSettings():** Acceso a configuraci√≥n

---

## 3. Tecnolog√≠as Utilizadas y Detalles Extra

### 3.1 Stack Tecnol√≥gico

#### Frontend Framework
- **Next.js 15.5.4**
  - Framework React con renderizado h√≠brido
  - App Router (nueva arquitectura)
  - Server Components
  - Optimizaciones autom√°ticas
  - File-based routing

#### Lenguaje
- **TypeScript 5.9.2**
  - Tipado est√°tico
  - Mejor autocompletado
  - Detecci√≥n de errores en desarrollo
  - Mejor mantenibilidad del c√≥digo

#### Librer√≠a de UI
- **React 18.3.1**
  - Componentes funcionales
  - Hooks modernos
  - Concurrent rendering
  - Automatic batching

### 3.2 Librer√≠as y Dependencias

#### UI Components (Radix UI)
Sistema de componentes accesibles y sin estilos predefinidos:
- `@radix-ui/react-dialog` - Modales
- `@radix-ui/react-dropdown-menu` - Men√∫s desplegables
- `@radix-ui/react-select` - Selectores
- `@radix-ui/react-tabs` - Pesta√±as
- `@radix-ui/react-tooltip` - Tooltips
- `@radix-ui/react-popover` - Popovers
- Y m√°s componentes...

#### Estilos
- **Tailwind CSS 4.x**
  - Utility-first CSS
  - Dise√±o responsive
  - Dark mode ready
  - Customizaci√≥n completa
- **tailwindcss-animate**
  - Animaciones predefinidas
- **class-variance-authority**
  - Variantes de componentes
- **clsx** & **tailwind-merge**
  - Gesti√≥n de clases CSS

#### Backend & Base de Datos
- **Supabase 2.57.4**
  - PostgreSQL como base de datos
  - Authentication integrada
  - Real-time subscriptions
  - Row Level Security (RLS)
  - Storage para archivos
- **@supabase/ssr 0.7.0**
  - Server-side rendering support
- **@supabase/auth-helpers-nextjs 0.10.0**
  - Helpers para Next.js

#### Visualizaci√≥n de Datos
- **Recharts 2.15.2**
  - Gr√°ficos en React
  - Altamente customizable
  - Responsive
  - Tipos: l√≠neas, barras, circular, √°rea

#### Formularios
- **React Hook Form 7.55.0**
  - Validaci√≥n de formularios
  - Performance optimizado
  - Menos re-renders
  - F√°cil integraci√≥n

#### Generaci√≥n de PDFs
- **jsPDF 3.0.3**
  - Generaci√≥n de facturas
  - Reportes en PDF
  - Customizable

#### UI/UX Adicionales
- **Lucide React 0.487.0**
  - Librer√≠a de iconos moderna
  - 1000+ iconos
  - Tree-shakeable
- **Sonner 2.0.7**
  - Sistema de notificaciones toast
  - Animaciones suaves
- **cmdk 1.1.1**
  - Command palette
  - B√∫squeda r√°pida
- **Embla Carousel 8.6.0**
  - Carruseles
- **Next Themes 0.4.6**
  - Dark/Light mode

#### Utilities
- **date-fns** (impl√≠cito en date-utils.ts)
  - Manipulaci√≥n de fechas
  - Formato colombiano

### 3.3 Estructura del Proyecto

```
ferreteria-pro/
‚îÇ
‚îú‚îÄ‚îÄ public/                      # Archivos est√°ticos
‚îÇ   ‚îú‚îÄ‚îÄ manifest.json           # PWA manifest
‚îÇ   ‚îî‚îÄ‚îÄ robots.txt              # SEO robots
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/                    # App Router (Next.js 13+)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx          # Layout principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx            # P√°gina principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sitemap.ts          # Sitemap autom√°tico
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ opengraph-image.tsx # OG image din√°mico
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ icon.tsx            # Favicon din√°mico
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/                # API Routes
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ admin/          # Rutas de admin
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ suppliers/      # Gesti√≥n de proveedores
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ create-user/    # Crear usuarios
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ components/             # Componentes React
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                 # Componentes UI base
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ button.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ card.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ table.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth-context.tsx    # Context de autenticaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory-dashboard.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ billing-system.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ lib/                    # Utilidades y configuraci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ supabase-client.ts  # Cliente Supabase (browser)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ supabase-server.ts  # Cliente Supabase (server)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ date-utils.ts       # Utilidades de fecha
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ supabase.ts         # Tipos y configs
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ hooks/                  # Custom React Hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ use-is-mobile.ts    # Detectar m√≥vil
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useSystemSettings.ts
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ guidelines/             # Documentaci√≥n
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Guidelines.md
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ globals.css             # Estilos globales
‚îÇ   ‚îú‚îÄ‚îÄ index.css               # Estilos base
‚îÇ   ‚îî‚îÄ‚îÄ middleware.ts           # Middleware de Next.js
‚îÇ
‚îú‚îÄ‚îÄ next.config.mjs             # Configuraci√≥n Next.js
‚îú‚îÄ‚îÄ tsconfig.json               # Configuraci√≥n TypeScript
‚îú‚îÄ‚îÄ package.json                # Dependencias
‚îú‚îÄ‚îÄ tailwind.config.js          # Configuraci√≥n Tailwind
‚îú‚îÄ‚îÄ postcss.config.js           # Configuraci√≥n PostCSS
‚îî‚îÄ‚îÄ README.md                   # Documentaci√≥n
```

### 3.4 Caracter√≠sticas Especiales

#### PWA (Progressive Web App)
- **Instalable:** Se puede instalar como app nativa
- **Offline-capable:** Funciona sin conexi√≥n (cache)
- **Responsive:** Se adapta a cualquier dispositivo
- **Manifest.json:** Configuraci√≥n de PWA

#### SEO Optimizado
- **Sitemap autom√°tico:** Generado din√°micamente
- **Robots.txt:** Configurado para crawlers
- **Open Graph:** Meta tags para redes sociales
- **Favicon din√°mico:** Generado con React

#### Internacionalizaci√≥n
- **Formato de fecha colombiano:**
  ```javascript
  formatColombiaDate() // "Lun, 20 Oct 2025"
  ```
- **Zona horaria Am√©rica/Bogot√°**
- **Moneda en pesos colombianos (COP)**

#### Real-time Updates
- **Supabase Realtime:**
  - Actualizaciones en tiempo real
  - M√∫ltiples usuarios simult√°neos
  - Sincronizaci√≥n autom√°tica

#### Dise√±o Responsive
- **Mobile-first:** Dise√±ado primero para m√≥vil
- **Breakpoints Tailwind:**
  - sm: 640px
  - md: 768px
  - lg: 1024px
  - xl: 1280px
  - 2xl: 1536px

#### Dark Mode
- **Sistema de temas:**
  - Light mode
  - Dark mode
  - Auto (seg√∫n sistema operativo)
- **Persistencia:** Preferencia guardada

#### Accesibilidad (a11y)
- **Radix UI:** Componentes accesibles por defecto
- **ARIA labels:** Etiquetas para lectores de pantalla
- **Navegaci√≥n por teclado:** Soporte completo
- **Contraste de colores:** WCAG AA compliant

### 3.5 Seguridad

#### Autenticaci√≥n
- **JWT Tokens:** Tokens seguros con firma
- **HttpOnly Cookies:** Protecci√≥n contra XSS
- **Refresh Tokens:** Renovaci√≥n autom√°tica
- **Session Management:** Control de sesiones

#### Autorizaci√≥n
- **Row Level Security (RLS):** Pol√≠ticas a nivel de fila en Supabase
- **Role-Based Access Control (RBAC):** Permisos por rol
- **API Route Protection:** Middleware de verificaci√≥n

#### Protecci√≥n de Datos
- **Encriptaci√≥n en tr√°nsito:** HTTPS/TLS
- **Encriptaci√≥n en reposo:** Datos encriptados en BD
- **Variables de entorno:** Credenciales protegidas
- **CORS configurado:** Or√≠genes permitidos

#### Validaci√≥n
- **Input validation:** Validaci√≥n en frontend y backend
- **SQL Injection protection:** Queries parametrizadas
- **XSS prevention:** Sanitizaci√≥n de inputs
- **CSRF tokens:** Protecci√≥n contra CSRF

### 3.6 Rendimiento

#### Optimizaciones de Next.js
- **Server Components:** Menos JavaScript al cliente
- **Automatic Code Splitting:** Carga solo lo necesario
- **Image Optimization:** Next/Image optimizado
- **Font Optimization:** Google Fonts optimizado
- **Static Generation:** P√°ginas est√°ticas donde sea posible

#### Optimizaciones de React
- **React.memo:** Evita re-renders innecesarios
- **useMemo/useCallback:** Memoizaci√≥n de valores y funciones
- **Lazy Loading:** Carga diferida de componentes
- **Suspense:** Carga progresiva

#### Optimizaciones de Base de Datos
- **Indexes:** √çndices en columnas frecuentes
- **Query Optimization:** Queries optimizadas
- **Connection Pooling:** Pool de conexiones
- **Caching:** Cache de queries frecuentes

#### M√©tricas de Rendimiento
- **Core Web Vitals:**
  - LCP (Largest Contentful Paint): < 2.5s
  - FID (First Input Delay): < 100ms
  - CLS (Cumulative Layout Shift): < 0.1
- **Lighthouse Score:** Objetivo 90+
- **Bundle Size:** Optimizado y tree-shaken

---

## üìù Notas Adicionales

### Requisitos del Sistema
- **Navegadores soportados:**
  - Chrome/Edge 90+
  - Firefox 88+
  - Safari 14+
  - Opera 76+
- **Conexi√≥n a internet:** Requerida
- **JavaScript:** Habilitado obligatorio

### Instalaci√≥n Local (Para Desarrolladores)
```bash
# Clonar repositorio
git clone [repository-url]

# Instalar dependencias
npm install

# Configurar variables de entorno
cp .env.example .env.local
# Editar .env.local con tus credenciales

# Ejecutar en desarrollo
npm run dev

# Construir para producci√≥n
npm run build

# Ejecutar en producci√≥n
npm start
```

### Variables de Entorno Requeridas
```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
```

### Soporte y Ayuda
Para soporte t√©cnico o reportar problemas:
1. Revisar este manual
2. Consultar la documentaci√≥n t√©cnica
3. Contactar al administrador del sistema
4. Revisar logs del sistema (para admins)

### Actualizaciones
El sistema se actualiza regularmente con:
- Nuevas funcionalidades
- Mejoras de seguridad
- Correcci√≥n de bugs
- Optimizaciones de rendimiento

---

## üéØ Conclusi√≥n

Este manual cubre todos los aspectos del sistema de gesti√≥n para ferreter√≠a, desde el uso b√°sico hasta los detalles t√©cnicos de implementaci√≥n. El sistema est√° dise√±ado para ser:

‚úÖ **F√°cil de usar:** Interfaz intuitiva y amigable
‚úÖ **Seguro:** M√∫ltiples capas de seguridad
‚úÖ **Escalable:** Crece con tu negocio
‚úÖ **R√°pido:** Optimizado para rendimiento
‚úÖ **Moderno:** Tecnolog√≠as de √∫ltima generaci√≥n
‚úÖ **Mantenible:** C√≥digo limpio y documentado

Para cualquier duda o sugerencia, no dudes en contactar al equipo de desarrollo.

---

**Versi√≥n del Manual:** 1.0
**√öltima Actualizaci√≥n:** Octubre 2025
**Sistema:** Ferreter√≠a Pro - Sistema de Gesti√≥n Integral
